<h1 class="text-center my-4">Carrito de Compras</h1>

<div *ngIf="carrito.length === 0" class="alert alert-warning text-center">
    <p>No hay productos en el carrito</p>
</div>

<div *ngIf="carrito.length > 0" class="container">

    <table class="table table-hover table-bordered align-middle text-center">
        <thead class="table-dark">
            <tr>
                <th>Imagen</th>
                <th>Nombre</th>
                <th>Descripción</th>
                <th>Precio</th>
                <th>Cantidad</th>
                <th>Subtotal</th>
                <th>Acciones</th>
            </tr>
        </thead>

        <tbody>
            <tr *ngFor="let item of carrito">

                <!-- Imagen -->
                <td>
                    <img *ngIf="item.imagen" [src]="'http://localhost/api_proyecto/public/uploads/' + item.imagen"
                        class="thumb" />
                </td>

                <!-- Nombre -->
                <td>
                    <strong>{{ item.nombre }}</strong>
                </td>

                <!-- Precio -->
                <td>$ {{ item.precio_unitario }}</td>

                <!-- Cantidad (editable) -->
                <td>
                    <input type="number" min="1" class="form-control" [value]="item.cantidad"
                        (change)="cambiarCantidad(item.id_detalle_carrito, $event)">
                </td>

                <!-- Subtotal -->
                <td>$ {{ item.subtotal }}</td>

                <!-- Eliminar -->
                <td>
                    <button class="btn btn-danger btn-sm" (click)="eliminar(item.id_detalle_carrito)">
                        Eliminar
                    </button>
                </td>

            </tr>
        </tbody>
    </table>

    <div class="text-end mt-4">
        <p>Subtotal: <strong>$ {{ total }}</strong></p>
        <p>Envío: <strong>$ {{ envio }}</strong></p>
        <p>Total: <strong>$ {{ total + envio }}</strong></p>

        <button class="btn btn-outline-danger me-2" (click)="vaciarCarrito()">
            Vaciar carrito
        </button>

        <button class="btn btn-primary" (click)="irACompra()">
            Finalizar compra
        </button>
    </div>  